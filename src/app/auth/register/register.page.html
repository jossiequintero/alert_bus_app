<ion-header>
  <ion-toolbar>
    <ion-title>
      AlertBus - Registrarse
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="ion-padding">
  <div class="register-container">
    <div class="logo-section">
      <ion-icon name="bus" size="large" color="primary"></ion-icon>
      <h1>AlertBus</h1>
      <p>Recibe alertas cuando tu autobús esté cerca</p>
    </div>

    <form [formGroup]="registerForm" (ngSubmit)="onRegister()">
      <ion-item>
        <ion-label position="stacked">Nombre</ion-label>
        <ion-input 
          type="name" 
          formControlName="name"
          placeholder="Tu Nombre">
        </ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Apellidos</ion-label>
        <ion-input 
          type="lastname" 
          formControlName="lastname"
          placeholder="Tu Apellido">
        </ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Correo electrónico</ion-label>
        <ion-input 
          type="email" 
          formControlName="email"
          placeholder="tu@email.com">
        </ion-input>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Contraseña</ion-label>
        <ion-input 
          type="password" 
          formControlName="password"
          placeholder="••••••••">
        </ion-input>
      </ion-item>
      
      <ion-item>
        <ion-label position="stacked">Confirmar Contraseña</ion-label>
        <ion-input 
          type="password" 
          formControlName="confirmPassword"
          placeholder="••••••••">
        </ion-input>
      </ion-item>
      
      <!-- Mensaje de error para contraseñas que no coinciden -->
      <ion-item *ngIf="!isRegisterMode && registerForm.get('confirmPassword')?.errors?.['passwordMismatch']" color="danger">
        <ion-label>
          <ion-text color="danger">Las contraseñas no coinciden</ion-text>
        </ion-label>
      </ion-item>

      <ion-item>
        <ion-label position="stacked">Tipo de usuario</ion-label>
        <ion-select formControlName="role" placeholder="Selecciona tu rol">
          <ion-select-option value="pasajero">Pasajero</ion-select-option>
          <ion-select-option value="conductor">Conductor</ion-select-option>
          <ion-select-option value="admin">Administrador</ion-select-option>
        </ion-select>
      </ion-item>

      <ion-button
        *ngIf="!isRegisterMode"
        expand="block"
        type="button"
        (click)="onRegister()"
        [disabled]="registerForm.invalid || isLoading"
        class="ion-margin-top">
        <ion-spinner *ngIf="isLoading" name="crescent"></ion-spinner>
        <span *ngIf="!isLoading">Registrarse</span>
      </ion-button>
    </form>

    <div class="register-section">
      <p>{{ isRegisterMode ?  '¿Ya tienes una cuenta?' : '¿No tienes cuenta?' }}</p>
      <ion-button 
        fill="clear" 
        (click)="toggleMode()"
        [disabled]="isLoading">
       {{'Registrarse'}}
      </ion-button>
    </div>
  </div>
</ion-content>
